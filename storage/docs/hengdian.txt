横店影视城酒店订单接口对接开发文档1.概述该接口为横店影视城酒店业务订单的接口，包括单酒店业务和套餐业务。通过该接口对接的订单财务通过月结方式进行结算。该接口包含4个功能：可订检查，下单预定，订单查询，取消订单，房态订阅和推送。第三方系统通过调用该接口完成下单前检查，酒店订单下单，取消，查询等操作。接口调用方式：第三方系统将XML请求的数据，通过POST请求方式发送给影视城酒店接口。影视城酒店接口会根据XML父节点区分业务类型，处理好业务之后，将响应以XML结构的方式返回给第三方系统。调用示 例 代 码 ( N od e J S 版本) :const axios = require('axios');let serverUrl = 'http://e.hengdianworld.com/hotelorder.aspx'let xml = '<ValidateRQ>....</ValidateRQ>'axios.post(serverUrl, xml).then(function(resp) {console.log(resp.data)let xmlData = resp.data//处 理 响 应 结 果})联系横店影视城的技术人员获取用户名和密码来获得接口调用权限。用户名是mpbxczl_common密码是是mpbxczl20250820!@#$2.环境测试环境地址：http://testhotel.hengdianworld.com/Interface/hotel_order.aspx正式环境地址：https://e.hengdianworld.com/Interface/hotel_order.aspx3.接口功能3.1 可订检查第三方系统在发送正式下单请求之前，通过该接口检查价格和库存。该请求XML的父节点是<ValidateRQ>。3.1.1请求参数名称 类型  必填 描述 示例值Username string 是 系统接口调用需要校验时的用户名testPassword string 是 系统接口调用需要校验时的密码 passwordPackageId string 否 影视城套餐ID，为空则表示单酒店 1064HotelId string 是 影视城酒店id 123456789RoomType string 是 房型 标准间CheckIn date 是 入住时间 2013-12-24CheckOut date 是 离店日期。 2013-12-26RoomNum int 是 房间数量（最大为9） 1CustomerNumber int 是 入住人数 2PaymentType int 是 支付方式1预付5面付6信用住 5Extensions string 否 扩展字段json {"key":"value"}请求XML示例XML<ValidateRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><PackageId>1064</PackageId><HotelId>001</HotelId><RoomType>标准间</RoomType><CheckIn>2021-10-27</CheckIn><CheckOut>2021-10-29</CheckOut><RoomNum>1</RoomNum><CustomerNumber>2</CustomerNumber><PaymentType>1</PaymentType><Extensions>{}</Extensions></ValidateRQ>3.1.2返回参数名称 类型 必填 描述 示例值Message String否 试单可能需要返回的一些描述信息123456ResultCode String 是 处理结果,0表示成功；非0表示失败，具体情况见下面错误码。 0InventoryPrice String是 价格日历：其中price是房费（单位是分），quota是剩余真实库存。 [{"date":"2015-01-01","price":21000,"quota":4},{"date":"2015-01-02","price":22000,"quota":4}]返回结果（成功）XML<Result><Message /><ResultCode>0</ResultCode><InventoryPrice> [{"date":"2021-11-07","price":76133, "quota":200},{"date":"2021-11-08","price":76133, "quota":200}</InventoryPrice></Result>返回结果（失败）XML<Result><Message>房间数量不足</Message><ResultCode>-1</ResultCode></Result>3.1.3 错误码名称 错误码 错误描述ResultCode 1000 房间数量不足。           1001 请求参数有误类型。入住时间错误/该套餐已经无效/找不到对应的房型/套餐不存在/房间数小于0      1002 产品配置错误。3.2 下单预定第三方系统通过接口对单酒店和套餐进行下单。单酒店和套餐通过PackageId进行区分，PackageId为空的情况下表示单酒单，否则表示套餐的Id。该请求XML的父节点是<BookRQ>。3.2.1请求参数名称 类型  必填 描述 示例值Username String 是 第三方系统接口调用需要校验时的用户名。 adminPassword String 是 第三方系统接口调用需要校验时的密码passwordOtaOrderId long 是 OTA订单id，第三方需根据此id判断订单是否已经存在，以实现幂等和避免重复下单。13877841232130314499122979PackageId string 否 影视城套餐ID，为空则表示单酒店 1064HotelId String 是 影视城酒店ID 001RoomType String 是 影视城酒店房型  标准间CheckIn Dtea是  入住时间 2013-12-24CheckOut Date是  离店日期。 2013-12-26Amount Int 是 订单总价 12300RoomNum int 是 房间数量（最大为9） 1PaymentType int 是 订单支付方式，只能填1 1ContactName String 是 联系人姓名 张三ContactTel String 是 联系人电话 138000000Name String 是 姓名 张三IdCode String 是  入住人证件号码 123456789Comment String 否 备注、特殊需求  要安静的房间Extensions String 否 扩展字段json请求XML示例XML<BookRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><OtaOrderId>13877841232130314499122979</OtaOrderId><HotelId>001</HotelId><RoomType>标准间</RoomType><CheckIn>2021-10-26</CheckIn><CheckOut>2021-10-27</CheckOut><Amount>100</Amount><RoomNum>1</RoomNum><PaymentType>1</PaymentType><ContactName>测试</ContactName><ContactTel>12345678901</ContactTel><OrderGuests><OrderGuest><Name>入住人1</Name><IdCode>12345678901</IdCode></OrderGuest></OrderGuests><Comment>测试备注</Comment><Extensions></Extensions></BookRQ>3.2.2 返回参数名称 类型  必填 描述 示例值Message String 是 处理结果 处理成功ResultCode String 是 处理结果，0表示成功；非0表示失败，具体情况见下面错误码。 0OtaOrderId String 是 OTA订单id，即第三方系统中的订单id 21544874OrderId String 是 影视城的确认单号 F15F190223Comment String 否 外部订单说明返回结果示例（成功）XML<Result><Message>创建订单成功</Message><ResultCode>0</ResultCode><OrderId >21544874</OrderId><OtaOrderId>F15F190223</OtaOrderId><Comment> 渠道A订单</Comment></Result>3.2.3 错误码名称 错误码 错误描述ResultCode 1000 房间数量不足。1001 请求参数有误类型。入住时间错误/该套餐已经无效/找不到对应的房型/套餐不存在/房间数小于01002 产品配置错误。3.3 订单查询第三方系统通过调用该接口查询订单信息，例如验证订单是否预定成功，订单是否已经使用等等。查询的关键信息是Ota方系统的订单号。该请求XML的父节点是< QueryStatusRQ >。3.3.1请求参数名称 类型 必填 描述 示例值Username String 是 第三方系统接口调用需要校验时的用户名 testPassword String 是 第三方系统接口调用需要校验时的密码 passwordOtaOrderId String 是 Ota订单号 524148745XML示例：XML<QueryStatusRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><OtaOrderId>13877841232130314499122979</OtaOrderId></QueryStatusRQ>3.3.2返回参数名称 类型 必填 描述 示例值Message String 是 处理结果 处理成功ResultCode String 是 处理结果，0表示成功 0OtaOrderId String 是 Ota订单号 1387784033263OrderId String 否 影视城订单号 21544874Status String 否 影视城系统订单状态 1表示预定成功；5表示已经使用；4表示已经取消Amount long 是 订单总价 12300Comment String 否 外部订单说明 渠道来源/其他订单标识OrderInfo OrderInfo 否 订单信息CheckIn Date 否入住时间 2021-10-24CheckOut Date 否 离店时间 2021-10-26RoomQuantity int 否 房间数量 2Hotel String 否 影视城酒店名称 贵宾楼大酒店RoomType String 否 房型名称 标准间BillInfo BillInfo 否 帐单信息DailyPrice List<Unit>  否 每日房费列表Date Date 否 日期 2021-10-21Price long 否  每日金额，总价（分） 220返回结果示例（成功）HTML<Result><Message /><ResultCode>0</ResultCode><Status>1</Status><OrderId>V2fr0540435sghy9</OrderId><OtaOrderId>13877841232130314499122979</OtaOrderId><Comment /><Amount>0</Amount><OrderInfo><CheckIn>2021-10-26</CheckIn><CheckOut>2021-10-27</CheckOut><RoomQuantity>1</RoomQuantity><Hotel>贵宾楼大酒店</Hotel><RoomType>标准间</RoomType></OrderInfo><BillInfo><DailyPrice><Unit><Date>2021-10-26</Date><Price>86800</Price></Unit></DailyPrice></BillInfo></Result>返回结果示例（失败）HTML<Result><Message>该订单找不到</Message><ResultCode>-301</ResultCode><Status /><OrderId /><OtaOrderId>138778412321303144991229791</OtaOrderId><Comment /><Amount>0</Amount></Result>3.4 取消订单在符合影视城酒店订单取消规则提前下，可以调用该接口取消订单。取消的关键信息是Ota方的订单号。该请求XML的父节点是< CancelRQ >。3.4.1请求参数名称 类型 必填 描述 示例值Userna me String 是 第三方系统接口调用需要校验时的用户名。 adminPassword String 是 第三方系统接口调用需要校验时的密码  passwordReason String 否 取消订单原因  用户取消OtaOrderId String 是 Ota系统单号 13877841232130314499122979XML请求示例:HTML<CancelRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><Reason>用户取消订单</Reason><OtaOrderId>13877841232130314499122979</OtaOrderId></CancelRQ>3.4.2 返回参数名称 类型  必填 描述 示例值Message String 是 处理结果 处理成功ResultCode String 是 处理结果，0表示成功 0OrderId String 是 OTA订单id 21544874Reason String 否 取消原因游客取消了订单返回结果示例（成功）：XML<HotelCancelResponse><Message>成功</Message><ResultCode>0</ResultCode></HotelCancelResponse>返回结果示例（失败）：XML<HotelCancelResponse><Message>订单已过期不能取消订单</Message><ResultCode>-200</ResultCode></HotelCancelResponse>3.5 房态订阅当第三方需要得到酒店的房态信息，首先需要调用房态订阅接口订阅所需的酒店和房型。订阅之后，影视城系统会每隔5分钟或者10分钟向第三方系统推送房态信息。当不需要某酒店的房态时，可以取消订阅。订阅，取消订阅，以及设置推送房态的地址都在一个接口中，通过不同的参数设置进行调用即可。该请求XML的父节点是< SubscribeRoomStatusRQ>。3.5.1请求参数名称 类型 必填 描述 示例值Username String 是 第三方系统接口调用需要校验时的用户名。 adminPassword String 是 第三方系统接口调用需要校验时的密码 passwordNotifyUrl String 否 第三方系统的得到房态推送的接收地址  http://www.test.comIsUnsubscribe String 是 是否是取消订阅 0：订阅 1：取消订阅Hotels List 否 订阅或取消订阅的酒店房型HotelId String 是 酒店编号 001RoomType String 是 房型名称  标准间XML请求示例（订阅）:XML<SubscribeRoomStatusRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><NotifyUrl>http://test.com</NotifyUrl><IsUnsubscribe>0</IsUnsubscribe><Hotels><Hotel><HotelId>001</HotelId><Rooms><RoomType>标准间</RoomType><RoomType>单人间</RoomType></Rooms></Hotel><Hotel><HotelId>002</HotelId><Rooms><RoomType>标准间</RoomType></Rooms></Hotel></Hotels><Extensions>{}</Extensions></SubscribeRoomStatusRQ>XML请求示例（取消订阅）:XML<SubscribeRoomStatusRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><NotifyUrl></NotifyUrl><IsUnsubscribe>1</IsUnsubscribe><Hotels><Hotel><HotelId>001</HotelId><Rooms><RoomType>标准间</RoomType></Rooms></Hotel></Hotels><Extensions>{}</Extensions></SubscribeRoomStatusRQ>XML请求示例（设置推送地址）:XML<SubscribeRoomStatusRQ><AuthenticationToken><Username>admin</Username><Password>password</Password></AuthenticationToken><NotifyUrl>http://test.com</NotifyUrl><IsUnsubscribe>0</IsUnsubscribe><Hotels></Hotels><Extensions>{}</Extensions></SubscribeRoomStatusRQ>3.5.2 返回参数名称 类型  必填 描述 示例值Message String 是 处理结果 处理成功ResultCode String 是 处理结果，0表示成功 0返回结果示例（成功）：XML<Result><Message>成功</Message><ResultCode>0</ResultCode></Result>3.6 房态推送该接口需要由第三方进行实现，然后将服务器url通过房态订阅接口进行设置。影视城的系统会每隔一定的时间调用该接口将房态信息推送给第三方。该请求XML的父节点是<RoomStatus>3.6.1请求参数名称 类型  必填 描述 示例值RoomQuotaMap String 是 房态信息，这是一个json数组的字符串。影视城系统会把多个酒店房型的房态信息放在这个数组中。hotelNo表示酒店编号，roomType是房型名称，roomQuota是房态信息。每一项表示日期以及对应的房态数量。 [{\"hotelNo\":\"001\",\"roomType\":\"标准间\",\"roomQuota\":[{\"date\":\"2021-10-21\",\"quota\":100},{\"date\":\"2021-10-22\",\"quota\":0}]XML请求示例（订阅）:XML<RoomStatus><RoomQuotaMap>[{\"hotelNo\":\"001\", \"roomType\":\"标准间\",\"roomQuota\":[{\"date\":\"2021-10-21\",\"quota\":100},{\"date\":\"2021-10-22\",\"quota\":0}]</RoomQuotaMap></RoomStatus>3.6.2 返回参数名称 类型 必填 描述 示例值Message String 是 处理结果 处理成功ResultCode String 是 处理结果，0表示成功 0返回结果示例（成功）：XML<Result><Message>成功</Message><ResultCode>0</ResultCode></Result>