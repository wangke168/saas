import{_ as U,r as x,i as $,c as b,o as f,f as s,b as l,w as a,d as v,k as j,E as q,l as A,s as y,m as O,h as i,q as D,t as r,F as G,p as H}from"./app-dwQB4-it.js";const J={class:"operation-report-container"},K={class:"period-tabs"},Q={key:0,class:"custom-date-range"},W={class:"report-content"},X={class:"stats-cards"},Z={class:"stat-detail"},tt={class:"stat-detail"},et={class:"stat-detail"},at={class:"stat-detail"},st={class:"status-distribution"},lt={class:"status-info"},nt={class:"status-count"},ot={class:"status-percentage"},rt={class:"status-amount"},dt={__name:"Index",setup(it){const k=x(!1),m=x("realtime"),_=x(null),o=x({period:"day",start_date:"",end_date:"",stats:{},order_stats:{},pkg_order_stats:{},status_distribution:[],platform_distribution:[],time_trend:[]}),w=async()=>{k.value=!0;try{const n={period:m.value};m.value==="custom"&&_.value&&_.value.length===2&&(n.start_date=_.value[0],n.end_date=_.value[1]);const t=await j.get("/operation-report",{params:n});o.value=t.data}catch(n){console.error("获取运营快报数据失败:",n),q.error("获取运营快报数据失败")}finally{k.value=!1}},I=()=>{m.value!=="custom"&&(_.value=null),w()},R=()=>{_.value&&_.value.length===2&&w()},h=n=>n?(Number(n)/100).toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00",B=()=>{var d,u;const n=((d=o.value.stats)==null?void 0:d.total_orders)||0,t=((u=o.value.stats)==null?void 0:u.confirmed_orders)||0;return n===0?"0.00":(t/n*100).toFixed(2)},T=()=>{var d,u;const n=((d=o.value.stats)==null?void 0:d.total_orders)||0,t=((u=o.value.stats)==null?void 0:u.verified_orders)||0;return n===0?"0.00":(t/n*100).toFixed(2)},E=()=>{var d,u;const n=((d=o.value.stats)==null?void 0:d.total_orders)||0,t=((u=o.value.stats)==null?void 0:u.cancelled_orders)||0;return n===0?"0.00":(t/n*100).toFixed(2)},P=(n,t)=>t==="order"?n==="confirmed"||n==="verified"?"success":n==="cancel_approved"||n==="rejected"?"danger":n==="paid_pending"||n==="confirming"?"warning":"info":t==="pkg_order"?n==="confirmed"?"success":n==="cancelled"||n==="failed"?"danger":n==="paid"?"warning":"info":"info";return $(()=>{w()}),(n,t)=>{const d=v("el-radio-button"),u=v("el-radio-group"),S=v("el-date-picker"),g=v("el-statistic"),c=v("el-card"),z=v("el-tag"),p=v("el-table-column"),C=v("el-table"),L=A("loading");return f(),b("div",J,[t[18]||(t[18]=s("h2",null,"运营快报",-1)),l(c,null,{default:a(()=>{var V,Y,F;return[s("div",K,[l(u,{modelValue:m.value,"onUpdate:modelValue":t[0]||(t[0]=e=>m.value=e),onChange:I},{default:a(()=>[l(d,{label:"realtime"},{default:a(()=>[...t[2]||(t[2]=[i("实时",-1)])]),_:1}),l(d,{label:"day"},{default:a(()=>[...t[3]||(t[3]=[i("过去一天",-1)])]),_:1}),l(d,{label:"week"},{default:a(()=>[...t[4]||(t[4]=[i("过去一周",-1)])]),_:1}),l(d,{label:"month"},{default:a(()=>[...t[5]||(t[5]=[i("过去一月",-1)])]),_:1}),l(d,{label:"custom"},{default:a(()=>[...t[6]||(t[6]=[i("自定义日期",-1)])]),_:1})]),_:1},8,["modelValue"])]),m.value==="custom"?(f(),b("div",Q,[l(S,{modelValue:_.value,"onUpdate:modelValue":t[1]||(t[1]=e=>_.value=e),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:R},null,8,["modelValue"])])):y("",!0),O((f(),b("div",W,[s("div",X,[l(c,{class:"stat-card"},{default:a(()=>{var e,M,N;return[l(g,{title:"订单总数",value:((e=o.value.stats)==null?void 0:e.total_orders)||0},{suffix:a(()=>[...t[7]||(t[7]=[s("span",{class:"stat-unit"},"单",-1)])]),_:1},8,["value"]),s("div",Z,[s("span",null,"普通订单: "+r(((M=o.value.order_stats)==null?void 0:M.total_orders)||0),1),s("span",null,"打包订单: "+r(((N=o.value.pkg_order_stats)==null?void 0:N.total_orders)||0),1)])]}),_:1}),l(c,{class:"stat-card"},{default:a(()=>{var e;return[l(g,{title:"订单总金额",value:(((e=o.value.stats)==null?void 0:e.total_amount)||0)/100,precision:2},{prefix:a(()=>[...t[8]||(t[8]=[s("span",{class:"stat-unit"},"¥",-1)])]),_:1},8,["value"]),t[9]||(t[9]=s("div",{class:"stat-detail"},[s("span",null,"销售总额")],-1))]}),_:1}),l(c,{class:"stat-card"},{default:a(()=>{var e;return[l(g,{title:"结算总金额",value:(((e=o.value.stats)==null?void 0:e.total_settlement_amount)||0)/100,precision:2},{prefix:a(()=>[...t[10]||(t[10]=[s("span",{class:"stat-unit"},"¥",-1)])]),_:1},8,["value"]),t[11]||(t[11]=s("div",{class:"stat-detail"},[s("span",null,"结算总额")],-1))]}),_:1}),l(c,{class:"stat-card"},{default:a(()=>{var e;return[l(g,{title:"已确认订单",value:((e=o.value.stats)==null?void 0:e.confirmed_orders)||0},{suffix:a(()=>[...t[12]||(t[12]=[s("span",{class:"stat-unit"},"单",-1)])]),_:1},8,["value"]),s("div",tt,[s("span",null,"确认率: "+r(B())+"%",1)])]}),_:1}),l(c,{class:"stat-card"},{default:a(()=>{var e;return[l(g,{title:"已核销订单",value:((e=o.value.stats)==null?void 0:e.verified_orders)||0},{suffix:a(()=>[...t[13]||(t[13]=[s("span",{class:"stat-unit"},"单",-1)])]),_:1},8,["value"]),s("div",et,[s("span",null,"核销率: "+r(T())+"%",1)])]}),_:1}),l(c,{class:"stat-card"},{default:a(()=>{var e;return[l(g,{title:"已取消订单",value:((e=o.value.stats)==null?void 0:e.cancelled_orders)||0},{suffix:a(()=>[...t[14]||(t[14]=[s("span",{class:"stat-unit"},"单",-1)])]),_:1},8,["value"]),s("div",at,[s("span",null,"取消率: "+r(E())+"%",1)])]}),_:1})]),((V=o.value.status_distribution)==null?void 0:V.length)>0?(f(),D(c,{key:0,class:"chart-card"},{header:a(()=>[...t[15]||(t[15]=[s("div",{class:"card-header"},[s("span",null,"订单状态分布")],-1)])]),default:a(()=>[s("div",st,[(f(!0),b(G,null,H(o.value.status_distribution,e=>(f(),b("div",{key:`${e.type}-${e.status}`,class:"status-item"},[s("div",lt,[l(z,{size:"small",type:P(e.status,e.type)},{default:a(()=>[i(r(e.label),1)]),_:2},1032,["type"]),s("span",nt,r(e.count)+" 单",1),s("span",ot,"("+r(e.percentage)+"%)",1)]),s("div",rt," ¥"+r(h(e.total_amount)),1)]))),128))])]),_:1})):y("",!0),((Y=o.value.platform_distribution)==null?void 0:Y.length)>0?(f(),D(c,{key:1,class:"chart-card"},{header:a(()=>[...t[16]||(t[16]=[s("div",{class:"card-header"},[s("span",null,"OTA平台分布")],-1)])]),default:a(()=>[l(C,{data:o.value.platform_distribution,border:""},{default:a(()=>[l(p,{prop:"name",label:"平台名称",width:"150"}),l(p,{prop:"count",label:"订单数",width:"120",align:"right"},{default:a(({row:e})=>[i(r(e.count)+" 单 ",1)]),_:1}),l(p,{prop:"percentage",label:"占比",width:"120",align:"right"},{default:a(({row:e})=>[i(r(e.percentage)+"% ",1)]),_:1}),l(p,{prop:"total_amount",label:"订单金额",align:"right"},{default:a(({row:e})=>[i(" ¥"+r(h(e.total_amount)),1)]),_:1}),l(p,{prop:"settlement_amount",label:"结算金额",align:"right"},{default:a(({row:e})=>[i(" ¥"+r(h(e.settlement_amount)),1)]),_:1})]),_:1},8,["data"])]),_:1})):y("",!0),((F=o.value.time_trend)==null?void 0:F.length)>0?(f(),D(c,{key:2,class:"chart-card"},{header:a(()=>[...t[17]||(t[17]=[s("div",{class:"card-header"},[s("span",null,"时间趋势")],-1)])]),default:a(()=>[l(C,{data:o.value.time_trend,border:""},{default:a(()=>[l(p,{prop:"date",label:"日期",width:"150"}),l(p,{prop:"count",label:"订单数",width:"120",align:"right"},{default:a(({row:e})=>[i(r(e.count)+" 单 ",1)]),_:1}),l(p,{prop:"total_amount",label:"订单金额",align:"right"},{default:a(({row:e})=>[i(" ¥"+r(h(e.total_amount)),1)]),_:1})]),_:1},8,["data"])]),_:1})):y("",!0)])),[[L,k.value]])]}),_:1})])}}},ct=U(dt,[["__scopeId","data-v-abd90785"]]);export{ct as default};
