import{r as b,i as D,c as S,o as i,f as T,b as s,w as a,d as l,j as u,E as r,k as z,h as c,l as L,n as _,t as f,s as v}from"./app-ZhZD_hbr.js";const I={__name:"Index",setup(M){const m=b([]),p=b(!1),d=async()=>{p.value=!0;try{const e=await u.get("/exception-orders");m.value=e.data.data}catch{r.error("获取异常订单列表失败")}finally{p.value=!1}},x=e=>({api_error:"接口报错",timeout:"超时",inventory_mismatch:"库存不匹配",price_mismatch:"价格不匹配"})[e]||e,k=e=>({pending:"待处理",processing:"处理中",resolved:"已解决"})[e]||e,h=e=>({pending:"danger",processing:"warning",resolved:"success"})[e]||"",w=async e=>{try{await u.post(`/exception-orders/${e.id}/start-processing`),r.success("已开始处理"),d()}catch{r.error("操作失败")}},C=async e=>{try{await u.post(`/exception-orders/${e.id}/resolve`),r.success("已标记为已解决"),d()}catch{r.error("操作失败")}};return D(()=>{d()}),(e,t)=>{const E=l("el-alert"),n=l("el-table-column"),g=l("el-tag"),y=l("el-button"),B=l("el-table"),N=l("el-card"),V=z("loading");return i(),S("div",null,[t[3]||(t[3]=T("h2",null,"异常订单处理",-1)),s(E,{type:"warning",closable:!1,style:{"margin-bottom":"20px"}},{default:a(()=>[...t[0]||(t[0]=[c(" 所有接口报错、超时、库存不匹配的订单都会显示在这里，请及时处理 ",-1)])]),_:1}),s(N,null,{default:a(()=>[L((i(),_(B,{data:m.value,border:""},{default:a(()=>[s(n,{prop:"order.order_no",label:"订单号",width:"180"}),s(n,{prop:"exception_type",label:"异常类型",width:"150"},{default:a(({row:o})=>[s(g,{type:"danger"},{default:a(()=>[c(f(x(o.exception_type)),1)]),_:2},1024)]),_:1}),s(n,{prop:"exception_message",label:"异常信息"}),s(n,{prop:"status",label:"处理状态",width:"120"},{default:a(({row:o})=>[s(g,{type:h(o.status)},{default:a(()=>[c(f(k(o.status)),1)]),_:2},1032,["type"])]),_:1}),s(n,{prop:"created_at",label:"创建时间",width:"180"}),s(n,{label:"操作",width:"200",fixed:"right"},{default:a(({row:o})=>[o.status==="pending"?(i(),_(y,{key:0,size:"small",type:"primary",onClick:$=>w(o)},{default:a(()=>[...t[1]||(t[1]=[c(" 开始处理 ",-1)])]),_:1},8,["onClick"])):v("",!0),o.status==="processing"?(i(),_(y,{key:1,size:"small",type:"success",onClick:$=>C(o)},{default:a(()=>[...t[2]||(t[2]=[c(" 已解决 ",-1)])]),_:1},8,["onClick"])):v("",!0)]),_:1})]),_:1},8,["data"])),[[V,p.value]])]),_:1})])}}};export{I as default};
