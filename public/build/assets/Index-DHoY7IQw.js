import{r as w,a as V,c as b,o as v,f as y,b as s,w as a,d as t,h as x,k,E as _}from"./app-BNkvmon8.js";const h={__name:"Index",setup(C){const d=w(null),p=w(!1),o=V({old_password:"",new_password:"",new_password_confirmation:""}),i={old_password:[{required:!0,message:"请输入当前密码",trigger:"blur"}],new_password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:8,message:"密码长度至少8位",trigger:"blur"}],new_password_confirmation:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:(u,e,r)=>{e!==o.new_password?r(new Error("两次输入的密码不一致")):r()},trigger:"blur"}]},m=async()=>{d.value&&await d.value.validate(async u=>{var e,r;if(u){p.value=!0;try{await k.post("/auth/change-password",o),_.success("密码修改成功"),o.old_password="",o.new_password="",o.new_password_confirmation=""}catch(l){_.error(((r=(e=l.response)==null?void 0:e.data)==null?void 0:r.message)||"密码修改失败")}finally{p.value=!1}}})};return(u,e)=>{const r=t("el-input"),l=t("el-form-item"),f=t("el-button"),c=t("el-form"),g=t("el-card");return v(),b("div",null,[e[4]||(e[4]=y("h2",null,"账号设置",-1)),s(g,null,{default:a(()=>[s(c,{model:o,rules:i,ref_key:"formRef",ref:d,"label-width":"120px"},{default:a(()=>[s(l,{label:"当前密码",prop:"old_password"},{default:a(()=>[s(r,{modelValue:o.old_password,"onUpdate:modelValue":e[0]||(e[0]=n=>o.old_password=n),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(l,{label:"新密码",prop:"new_password"},{default:a(()=>[s(r,{modelValue:o.new_password,"onUpdate:modelValue":e[1]||(e[1]=n=>o.new_password=n),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(l,{label:"确认新密码",prop:"new_password_confirmation"},{default:a(()=>[s(r,{modelValue:o.new_password_confirmation,"onUpdate:modelValue":e[2]||(e[2]=n=>o.new_password_confirmation=n),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),s(l,null,{default:a(()=>[s(f,{type:"primary",loading:p.value,onClick:m},{default:a(()=>[...e[3]||(e[3]=[x(" 修改密码 ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])}}};export{h as default};
