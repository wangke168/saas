import{_ as il,u as rl,r as s,x as X,i as dl,c as be,o as R,f as q,b as l,w as t,d as g,k as V,E as m,l as pl,m as Ve,h as d,F as Ue,p as Te,q as L,y as ml,z as vl,t as x,v as $e}from"./app-CQIcOIsZ.js";const cl={style:{"margin-bottom":"20px"}},yl={style:{"margin-bottom":"20px"}},fl={style:{"margin-left":"20px",color:"#909399"}},_l={style:{"margin-bottom":"20px"}},gl={style:{"margin-right":"20px"}},bl={style:{"margin-left":"10px",color:"#909399","font-size":"12px"}},Vl={__name:"Index",setup(xl){const N=rl(),xe=s([]),S=s([]),ee=s(!1),le=s(!1),$=s(!1),P=s(null),O=s(""),Z=s(null),F=s(1),ae=s(15),qe=s(0),j=s(null),te=s(!1),oe=s([]),ne=s(!1),I=s(null),z=s(!1),K=s(null),ue=s(!1),B=s(null),se=s(!1),ie=s([]),re=s(!1),h=s(null),U=s(null),E=s(!1),Y=s(null),de=s(!1),M=s(!1),G=s(null),pe=s(!1),J=s(null),me=s({}),ve=X(()=>j.value!==null),Ie=X(()=>ve.value?"编辑酒店":"创建酒店"),we=X(()=>B.value!==null),ze=X(()=>we.value?"编辑房型":"添加房型"),v=s({scenic_spot_id:null,name:"",code:"",external_code:"",address:"",contact_phone:"",is_connected:!1,is_active:!0}),_=s({name:"",code:"",external_code:"",max_occupancy:2,description:"",is_active:!0}),w=s({dateRange:null,total_quantity:0,available_quantity:0}),b=s({date:null,total_quantity:0,available_quantity:0,source:"manual"}),De={scenic_spot_id:[{required:!0,message:"请选择所属景区",trigger:"change"}],name:[{required:!0,message:"请输入酒店名称",trigger:"blur"},{max:255,message:"酒店名称不能超过255个字符",trigger:"blur"}],code:[{pattern:/^[a-zA-Z0-9_-]+$/,message:"酒店编码只能包含字母、数字、下划线和连字符",trigger:"blur"}],contact_phone:[{pattern:/^1[3-9]\d{9}$|^0\d{2,3}-?\d{7,8}$/,message:"请输入正确的电话号码",trigger:"blur"}]},Se={name:[{required:!0,message:"请输入房型名称",trigger:"blur"}],code:[{pattern:/^[a-zA-Z0-9_-]+$/,message:"房型编码只能包含字母、数字、下划线和连字符",trigger:"blur"}],max_occupancy:[{required:!0,message:"请输入最大入住人数",trigger:"blur"},{type:"number",min:1,message:"最大入住人数至少为1",trigger:"blur"}]},Fe={dateRange:[{required:!0,message:"请选择日期范围",trigger:"change"}],total_quantity:[{required:!0,message:"请输入总库存",trigger:"blur"},{type:"number",min:0,message:"总库存不能小于0",trigger:"blur"}],available_quantity:[{required:!0,message:"请输入可用库存",trigger:"blur"},{type:"number",min:0,message:"可用库存不能小于0",trigger:"blur"}]},Be={total_quantity:[{required:!0,message:"请输入总库存",trigger:"blur"},{type:"number",min:0,message:"总库存不能小于0",trigger:"blur"}],available_quantity:[{required:!0,message:"请输入可用库存",trigger:"blur"},{type:"number",min:0,message:"可用库存不能小于0",trigger:"blur"}]},T=async()=>{ee.value=!0;try{const a={page:F.value,per_page:ae.value};Z.value&&(a.scenic_spot_id=Z.value),O.value&&(a.search=O.value);const e=await V.get("/hotels",{params:a});xe.value=e.data.data||[],qe.value=e.data.total||0}catch(a){m.error("获取酒店列表失败"),console.error(a)}finally{ee.value=!1}},Ee=async()=>{var a,e,n;try{if(((a=N.user)==null?void 0:a.role)!=="admin")S.value=((e=N.user)==null?void 0:e.scenic_spots)||[];else{const p=await V.get("/scenic-spots");S.value=p.data.data||[]}}catch(p){console.error("获取景区列表失败",p),(n=N.user)!=null&&n.scenic_spots&&(S.value=N.user.scenic_spots)}},Me=()=>{F.value=1,T()},Ae=()=>{F.value=1,T()},He=()=>{j.value=null,Ce(),$.value=!0},Le=a=>{j.value=a.id,v.value={scenic_spot_id:a.scenic_spot_id,name:a.name,code:a.code,external_code:a.external_code||"",address:a.address||"",contact_phone:a.contact_phone||"",is_connected:a.is_connected||!1,is_active:a.is_active},$.value=!0},Ne=async()=>{P.value&&await P.value.validate(async a=>{var e,n,p,f,C,c;if(a){le.value=!0;try{ve.value?(await V.put(`/hotels/${j.value}`,v.value),m.success("酒店更新成功")):(await V.post("/hotels",v.value),m.success("酒店创建成功")),$.value=!1,T()}catch(r){const k=((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.message)||((c=(C=(f=(p=r.response)==null?void 0:p.data)==null?void 0:f.errors)==null?void 0:C.code)==null?void 0:c[0])||"操作失败";m.error(k)}finally{le.value=!1}}})},Pe=async a=>{try{await $e.confirm(`确定要删除酒店"${a.name}"吗？删除后无法恢复！`,"提示",{type:"warning",confirmButtonText:"确定删除",cancelButtonText:"取消"}),await V.delete(`/hotels/${a.id}`),m.success("删除成功"),T()}catch(e){e!=="cancel"&&(m.error("删除失败"),console.error(e))}},Ce=()=>{var a;v.value={scenic_spot_id:null,name:"",code:"",external_code:"",address:"",contact_phone:"",is_connected:!1,is_active:!0},(a=P.value)==null||a.clearValidate()},Oe=async a=>{I.value=a,te.value=!0,await ce(a.id)},ce=async a=>{ne.value=!0;try{const e=await V.get("/room-types",{params:{hotel_id:a}});oe.value=e.data.data||[]}catch(e){m.error("获取房型列表失败"),console.error(e)}finally{ne.value=!1}},Ze=()=>{B.value=null,ke(),z.value=!0},je=a=>{B.value=a.id,_.value={name:a.name,code:a.code,external_code:a.external_code||"",max_occupancy:a.max_occupancy||2,description:a.description||"",is_active:a.is_active},z.value=!0},Ke=async()=>{K.value&&await K.value.validate(async a=>{var e,n,p,f,C,c;if(a){ue.value=!0;try{const r={..._.value,hotel_id:I.value.id};we.value?(await V.put(`/room-types/${B.value}`,r),m.success("房型更新成功")):(await V.post("/room-types",r),m.success("房型创建成功")),z.value=!1,await ce(I.value.id)}catch(r){const k=((n=(e=r.response)==null?void 0:e.data)==null?void 0:n.message)||((c=(C=(f=(p=r.response)==null?void 0:p.data)==null?void 0:f.errors)==null?void 0:C.code)==null?void 0:c[0])||"操作失败";m.error(k)}finally{ue.value=!1}}})},Ye=async a=>{try{await $e.confirm(`确定要删除房型"${a.name}"吗？删除后无法恢复！`,"提示",{type:"warning",confirmButtonText:"确定删除",cancelButtonText:"取消"}),await V.delete(`/room-types/${a.id}`),m.success("删除成功"),await ce(I.value.id)}catch(e){e!=="cancel"&&(m.error("删除失败"),console.error(e))}},ke=()=>{var a;_.value={name:"",code:"",external_code:"",max_occupancy:2,description:"",is_active:!0},(a=K.value)==null||a.clearValidate()},Ge=()=>{I.value=null,oe.value=[],B.value=null},Je=async a=>{h.value=a,se.value=!0,await A(a.id)},A=async a=>{re.value=!0;try{const e={room_type_id:a};U.value&&U.value.length===2&&(e.start_date=Q(U.value[0]),e.end_date=Q(U.value[1]));const n=await V.get("/inventories",{params:e});ie.value=n.data.data||[]}catch(e){m.error("获取库存列表失败"),console.error(e)}finally{re.value=!1}},Qe=()=>{h.value&&A(h.value.id)},We=()=>{he(),E.value=!0},Xe=async()=>{Y.value&&await Y.value.validate(async a=>{var e,n;if(a){de.value=!0;try{const[p,f]=w.value.dateRange,C=[],c=new Date(p),r=new Date(f);for(;c<=r;)C.push({date:Q(c),total_quantity:w.value.total_quantity,available_quantity:w.value.available_quantity}),c.setDate(c.getDate()+1);await V.post("/inventories",{room_type_id:h.value.id,inventories:C}),m.success("批量添加库存成功"),E.value=!1,await A(h.value.id)}catch(p){const f=((n=(e=p.response)==null?void 0:e.data)==null?void 0:n.message)||"操作失败";m.error(f)}finally{de.value=!1}}})},el=a=>{if(a.source==="api"){m.warning("接口推送的库存不可编辑");return}J.value=a.id,b.value={date:a.date,total_quantity:a.total_quantity,available_quantity:a.available_quantity,source:a.source},M.value=!0},ll=async()=>{G.value&&await G.value.validate(async a=>{var e,n;if(a){pe.value=!0;try{await V.put(`/inventories/${J.value}`,{total_quantity:b.value.total_quantity,available_quantity:b.value.available_quantity}),m.success("库存更新成功"),M.value=!1,await A(h.value.id)}catch(p){const f=((n=(e=p.response)==null?void 0:e.data)==null?void 0:n.message)||"操作失败";m.error(f)}finally{pe.value=!1}}})},al=async a=>{try{const e=a.is_closed?"open":"close";await V.post(`/inventories/${a.id}/${e}`),m.success(a.is_closed?"库存已开启":"库存已关闭"),await A(h.value.id)}catch(e){m.error("操作失败"),console.error(e)}},tl=async a=>{var e,n;try{me.value[a.id]=!0;const p=await V.post(`/inventories/${a.id}/push-to-ota`);p.data.success?m.success("推送任务已提交，正在后台处理中"):m.error(p.data.message||"推送失败")}catch(p){const f=((n=(e=p.response)==null?void 0:e.data)==null?void 0:n.message)||"推送失败";m.error(f),console.error(p)}finally{me.value[a.id]=!1}},he=()=>{var a;w.value={dateRange:null,total_quantity:0,available_quantity:0},(a=Y.value)==null||a.clearValidate()},ol=()=>{var a;b.value={date:null,total_quantity:0,available_quantity:0,source:"manual"},(a=G.value)==null||a.clearValidate(),J.value=null},nl=()=>{h.value=null,ie.value=[],U.value=null,J.value=null},Q=a=>{if(!a)return"";const e=new Date(a),n=e.getFullYear(),p=String(e.getMonth()+1).padStart(2,"0"),f=String(e.getDate()).padStart(2,"0");return`${n}-${p}-${f}`};return dl(()=>{T(),Ee()}),(a,e)=>{const n=g("el-button"),p=g("el-option"),f=g("el-select"),C=g("el-icon"),c=g("el-input"),r=g("el-table-column"),k=g("el-tag"),ye=g("el-table"),ul=g("el-pagination"),sl=g("el-card"),y=g("el-form-item"),fe=g("el-switch"),W=g("el-form"),D=g("el-dialog"),H=g("el-input-number"),_e=g("el-date-picker"),ge=pl("loading");return R(),be("div",null,[e[59]||(e[59]=q("h2",null,"酒店管理",-1)),l(sl,null,{default:t(()=>[q("div",cl,[l(n,{type:"primary",onClick:He},{default:t(()=>[...e[35]||(e[35]=[d("创建酒店",-1)])]),_:1}),l(f,{modelValue:Z.value,"onUpdate:modelValue":e[0]||(e[0]=o=>Z.value=o),placeholder:"筛选景区",clearable:"",style:{width:"200px","margin-left":"10px"},onChange:Ae},{default:t(()=>[(R(!0),be(Ue,null,Te(S.value,o=>(R(),L(p,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(c,{modelValue:O.value,"onUpdate:modelValue":e[1]||(e[1]=o=>O.value=o),placeholder:"搜索酒店名称、编码或外部编号",style:{width:"300px","margin-left":"10px"},clearable:"",onInput:Me},{prefix:t(()=>[l(C,null,{default:t(()=>[l(ml(vl))]),_:1})]),_:1},8,["modelValue"])]),Ve((R(),L(ye,{data:xe.value,border:""},{default:t(()=>[l(r,{prop:"name",label:"酒店名称",width:"200"}),l(r,{prop:"code",label:"酒店编码",width:"150"}),l(r,{prop:"external_code",label:"外部酒店编号",width:"150"},{default:t(({row:o})=>[d(x(o.external_code||"-"),1)]),_:1}),l(r,{label:"所属景区",width:"150"},{default:t(({row:o})=>{var i;return[d(x(((i=o.scenic_spot)==null?void 0:i.name)||"-"),1)]}),_:1}),l(r,{prop:"address",label:"地址","show-overflow-tooltip":""}),l(r,{prop:"contact_phone",label:"联系电话",width:"150"}),l(r,{label:"系统服务商",width:"150"},{default:t(({row:o})=>{var i,u;return[d(x(((u=(i=o.scenic_spot)==null?void 0:i.software_provider)==null?void 0:u.name)||"-"),1)]}),_:1}),l(r,{prop:"is_connected",label:"是否直连",width:"100"},{default:t(({row:o})=>[l(k,{type:o.is_connected?"success":"info"},{default:t(()=>[d(x(o.is_connected?"是":"否"),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"is_active",label:"状态",width:"100"},{default:t(({row:o})=>[l(k,{type:o.is_active?"success":"danger"},{default:t(()=>[d(x(o.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"操作",width:"300",fixed:"right"},{default:t(({row:o})=>[l(n,{size:"small",onClick:i=>Oe(o)},{default:t(()=>[...e[36]||(e[36]=[d("管理房型",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",onClick:i=>Le(o)},{default:t(()=>[...e[37]||(e[37]=[d("编辑",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",type:"danger",onClick:i=>Pe(o)},{default:t(()=>[...e[38]||(e[38]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,ee.value]]),l(ul,{"current-page":F.value,"onUpdate:currentPage":e[2]||(e[2]=o=>F.value=o),"page-size":ae.value,"onUpdate:pageSize":e[3]||(e[3]=o=>ae.value=o),"page-sizes":[10,20,50,100],total:qe.value,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px"},onSizeChange:T,onCurrentChange:T},null,8,["current-page","page-size","total"])]),_:1}),l(D,{modelValue:$.value,"onUpdate:modelValue":e[13]||(e[13]=o=>$.value=o),title:Ie.value,width:"600px",onClose:Ce},{footer:t(()=>[l(n,{onClick:e[12]||(e[12]=o=>$.value=!1)},{default:t(()=>[...e[42]||(e[42]=[d("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:Ne,loading:le.value},{default:t(()=>[...e[43]||(e[43]=[d("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(W,{ref_key:"formRef",ref:P,model:v.value,rules:De,"label-width":"120px"},{default:t(()=>[l(y,{label:"所属景区",prop:"scenic_spot_id"},{default:t(()=>[l(f,{modelValue:v.value.scenic_spot_id,"onUpdate:modelValue":e[4]||(e[4]=o=>v.value.scenic_spot_id=o),placeholder:"请选择景区",style:{width:"100%"},disabled:ve.value},{default:t(()=>[(R(!0),be(Ue,null,Te(S.value,o=>(R(),L(p,{key:o.id,label:o.name,value:o.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),l(y,{label:"酒店名称",prop:"name"},{default:t(()=>[l(c,{modelValue:v.value.name,"onUpdate:modelValue":e[5]||(e[5]=o=>v.value.name=o),placeholder:"请输入酒店名称"},null,8,["modelValue"])]),_:1}),l(y,{label:"酒店编码",prop:"code"},{default:t(()=>[l(c,{modelValue:v.value.code,"onUpdate:modelValue":e[6]||(e[6]=o=>v.value.code=o),placeholder:"系统自动生成",disabled:!0},null,8,["modelValue"]),e[39]||(e[39]=q("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 酒店编码由系统自动生成，格式：H + 5位数字（如 H00001） ",-1))]),_:1}),l(y,{label:"外部酒店编号",prop:"external_code"},{default:t(()=>[l(c,{modelValue:v.value.external_code,"onUpdate:modelValue":e[7]||(e[7]=o=>v.value.external_code=o),placeholder:"用于资源方系统对接的酒店编号（可选）"},null,8,["modelValue"]),e[40]||(e[40]=q("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 如果配置了外部编号，系统将优先使用外部编号与资源方系统对接；如果为空，则使用酒店编码 ",-1))]),_:1}),l(y,{label:"地址",prop:"address"},{default:t(()=>[l(c,{modelValue:v.value.address,"onUpdate:modelValue":e[8]||(e[8]=o=>v.value.address=o),placeholder:"请输入酒店地址"},null,8,["modelValue"])]),_:1}),l(y,{label:"联系电话",prop:"contact_phone"},{default:t(()=>[l(c,{modelValue:v.value.contact_phone,"onUpdate:modelValue":e[9]||(e[9]=o=>v.value.contact_phone=o),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1}),l(y,{label:"是否直连",prop:"is_connected"},{default:t(()=>[l(fe,{modelValue:v.value.is_connected,"onUpdate:modelValue":e[10]||(e[10]=o=>v.value.is_connected=o)},null,8,["modelValue"]),e[41]||(e[41]=q("span",{style:{"margin-left":"10px",color:"#909399","font-size":"12px"}}," 开启后，系统将自动处理该酒店的订单 ",-1))]),_:1}),l(y,{label:"状态",prop:"is_active"},{default:t(()=>[l(fe,{modelValue:v.value.is_active,"onUpdate:modelValue":e[11]||(e[11]=o=>v.value.is_active=o)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(D,{modelValue:te.value,"onUpdate:modelValue":e[34]||(e[34]=o=>te.value=o),title:"房型管理",width:"1200px",onClose:Ge},{default:t(()=>{var o;return[q("div",yl,[l(n,{type:"primary",onClick:Ze},{default:t(()=>[...e[44]||(e[44]=[d("添加房型",-1)])]),_:1}),q("span",fl," 酒店："+x((o=I.value)==null?void 0:o.name),1)]),Ve((R(),L(ye,{data:oe.value,border:""},{default:t(()=>[l(r,{prop:"name",label:"房型名称",width:"150"}),l(r,{prop:"code",label:"房型编码",width:"150"}),l(r,{prop:"max_occupancy",label:"最大入住人数",width:"120"}),l(r,{prop:"description",label:"描述","show-overflow-tooltip":""}),l(r,{prop:"is_active",label:"状态",width:"100"},{default:t(({row:i})=>[l(k,{type:i.is_active?"success":"danger"},{default:t(()=>[d(x(i.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"操作",width:"250",fixed:"right"},{default:t(({row:i})=>[l(n,{size:"small",onClick:u=>Je(i)},{default:t(()=>[...e[45]||(e[45]=[d("管理库存",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",onClick:u=>je(i)},{default:t(()=>[...e[46]||(e[46]=[d("编辑",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",type:"danger",onClick:u=>Ye(i)},{default:t(()=>[...e[47]||(e[47]=[d("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ge,ne.value]]),l(D,{modelValue:z.value,"onUpdate:modelValue":e[21]||(e[21]=i=>z.value=i),title:ze.value,width:"500px","append-to-body":"",onClose:ke},{footer:t(()=>[l(n,{onClick:e[20]||(e[20]=i=>z.value=!1)},{default:t(()=>[...e[50]||(e[50]=[d("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:Ke,loading:ue.value},{default:t(()=>[...e[51]||(e[51]=[d("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(W,{ref_key:"roomTypeFormRef",ref:K,model:_.value,rules:Se,"label-width":"120px"},{default:t(()=>[l(y,{label:"房型名称",prop:"name"},{default:t(()=>[l(c,{modelValue:_.value.name,"onUpdate:modelValue":e[14]||(e[14]=i=>_.value.name=i),placeholder:"请输入房型名称"},null,8,["modelValue"])]),_:1}),l(y,{label:"房型编码",prop:"code"},{default:t(()=>[l(c,{modelValue:_.value.code,"onUpdate:modelValue":e[15]||(e[15]=i=>_.value.code=i),placeholder:"系统自动生成",disabled:!0},null,8,["modelValue"]),e[48]||(e[48]=q("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 房型编码由系统自动生成，格式：R + 5位数字（如 R00001） ",-1))]),_:1}),l(y,{label:"外部房型标识",prop:"external_code"},{default:t(()=>[l(c,{modelValue:_.value.external_code,"onUpdate:modelValue":e[16]||(e[16]=i=>_.value.external_code=i),placeholder:"用于资源方系统对接的房型标识（可选）"},null,8,["modelValue"]),e[49]||(e[49]=q("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 如果配置了外部标识，系统将优先使用外部标识与资源方系统对接；如果为空，则使用房型名称。注意：必须与资源方系统中的房型名称完全一致 ",-1))]),_:1}),l(y,{label:"最大入住人数",prop:"max_occupancy"},{default:t(()=>[l(H,{modelValue:_.value.max_occupancy,"onUpdate:modelValue":e[17]||(e[17]=i=>_.value.max_occupancy=i),min:1,max:10},null,8,["modelValue"])]),_:1}),l(y,{label:"描述",prop:"description"},{default:t(()=>[l(c,{modelValue:_.value.description,"onUpdate:modelValue":e[18]||(e[18]=i=>_.value.description=i),type:"textarea",rows:3,placeholder:"请输入房型描述"},null,8,["modelValue"])]),_:1}),l(y,{label:"状态",prop:"is_active"},{default:t(()=>[l(fe,{modelValue:_.value.is_active,"onUpdate:modelValue":e[19]||(e[19]=i=>_.value.is_active=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),l(D,{modelValue:se.value,"onUpdate:modelValue":e[33]||(e[33]=i=>se.value=i),title:"库存管理",width:"1000px","append-to-body":"",onClose:nl},{default:t(()=>{var i;return[q("div",_l,[q("span",gl,"房型："+x((i=h.value)==null?void 0:i.name),1),l(n,{type:"primary",onClick:We},{default:t(()=>[...e[52]||(e[52]=[d("批量添加库存",-1)])]),_:1}),l(_e,{modelValue:U.value,"onUpdate:modelValue":e[22]||(e[22]=u=>U.value=u),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{"margin-left":"20px"},onChange:Qe},null,8,["modelValue"])]),Ve((R(),L(ye,{data:ie.value,border:""},{default:t(()=>[l(r,{prop:"date",label:"日期",width:"120"},{default:t(({row:u})=>[d(x(Q(u.date)),1)]),_:1}),l(r,{prop:"total_quantity",label:"总库存",width:"100"}),l(r,{prop:"available_quantity",label:"可用库存",width:"100"}),l(r,{prop:"locked_quantity",label:"锁定库存",width:"100"}),l(r,{prop:"source",label:"来源",width:"100"},{default:t(({row:u})=>[l(k,{type:u.source==="manual"?"primary":"success"},{default:t(()=>[d(x(u.source==="manual"?"人工维护":"接口推送"),1)]),_:2},1032,["type"])]),_:1}),l(r,{prop:"is_closed",label:"状态",width:"100"},{default:t(({row:u})=>[l(k,{type:u.is_closed?"danger":"success"},{default:t(()=>[d(x(u.is_closed?"已关闭":"正常"),1)]),_:2},1032,["type"])]),_:1}),l(r,{label:"操作",width:"300",fixed:"right"},{default:t(({row:u})=>[l(n,{size:"small",onClick:Re=>el(u)},{default:t(()=>[...e[53]||(e[53]=[d("编辑",-1)])]),_:1},8,["onClick"]),l(n,{size:"small",type:u.is_closed?"success":"warning",onClick:Re=>al(u)},{default:t(()=>[d(x(u.is_closed?"开启":"关闭"),1)]),_:2},1032,["type","onClick"]),l(n,{size:"small",type:"primary",onClick:Re=>tl(u),loading:me.value[u.id]},{default:t(()=>[...e[54]||(e[54]=[d(" 推送到OTA ",-1)])]),_:1},8,["onClick","loading"])]),_:1})]),_:1},8,["data"])),[[ge,re.value]]),l(D,{modelValue:E.value,"onUpdate:modelValue":e[27]||(e[27]=u=>E.value=u),title:"批量添加库存",width:"600px","append-to-body":"",onClose:he},{footer:t(()=>[l(n,{onClick:e[26]||(e[26]=u=>E.value=!1)},{default:t(()=>[...e[55]||(e[55]=[d("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:Xe,loading:de.value},{default:t(()=>[...e[56]||(e[56]=[d("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[l(W,{ref_key:"batchInventoryFormRef",ref:Y,model:w.value,rules:Fe,"label-width":"120px"},{default:t(()=>[l(y,{label:"日期范围",prop:"dateRange"},{default:t(()=>[l(_e,{modelValue:w.value.dateRange,"onUpdate:modelValue":e[23]||(e[23]=u=>w.value.dateRange=u),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(y,{label:"总库存",prop:"total_quantity"},{default:t(()=>[l(H,{modelValue:w.value.total_quantity,"onUpdate:modelValue":e[24]||(e[24]=u=>w.value.total_quantity=u),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(y,{label:"可用库存",prop:"available_quantity"},{default:t(()=>[l(H,{modelValue:w.value.available_quantity,"onUpdate:modelValue":e[25]||(e[25]=u=>w.value.available_quantity=u),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),l(D,{modelValue:M.value,"onUpdate:modelValue":e[32]||(e[32]=u=>M.value=u),title:"编辑库存",width:"500px","append-to-body":"",onClose:ol},{footer:t(()=>[l(n,{onClick:e[31]||(e[31]=u=>M.value=!1)},{default:t(()=>[...e[57]||(e[57]=[d("取消",-1)])]),_:1}),l(n,{type:"primary",onClick:ll,loading:pe.value,disabled:b.value.source==="api"},{default:t(()=>[...e[58]||(e[58]=[d(" 确定 ",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[l(W,{ref_key:"inventoryFormRef",ref:G,model:b.value,rules:Be,"label-width":"120px"},{default:t(()=>[l(y,{label:"日期"},{default:t(()=>[l(_e,{modelValue:b.value.date,"onUpdate:modelValue":e[28]||(e[28]=u=>b.value.date=u),type:"date",placeholder:"选择日期",style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),l(y,{label:"总库存",prop:"total_quantity"},{default:t(()=>[l(H,{modelValue:b.value.total_quantity,"onUpdate:modelValue":e[29]||(e[29]=u=>b.value.total_quantity=u),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(y,{label:"可用库存",prop:"available_quantity"},{default:t(()=>[l(H,{modelValue:b.value.available_quantity,"onUpdate:modelValue":e[30]||(e[30]=u=>b.value.available_quantity=u),min:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(y,{label:"来源"},{default:t(()=>[l(k,{type:b.value.source==="manual"?"primary":"success"},{default:t(()=>[d(x(b.value.source==="manual"?"人工维护":"接口推送"),1)]),_:1},8,["type"]),q("span",bl,x(b.value.source==="manual"?"（可编辑）":"（接口推送，不可编辑）"),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])]}),_:1},8,["modelValue"])]}),_:1},8,["modelValue"])])}}},wl=il(Vl,[["__scopeId","data-v-a045d698"]]);export{wl as default};
