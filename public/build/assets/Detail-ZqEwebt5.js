import{r as c,A as j,i as Xe,c as ge,o as T,b as a,m as re,w as t,d as b,l as Ze,q as Y,k as S,x as ea,E as d,e as aa,f as w,s as ue,h as i,t as m,v as fe}from"./app-R4Sboner.js";const la={key:0},ta={style:{"margin-bottom":"20px"}},oa={style:{"margin-bottom":"20px"}},sa={style:{"margin-right":"20px"}},ra={style:{"margin-left":"10px",color:"#909399","font-size":"12px"}},ia={__name:"Detail",setup(ua){const z=ea(),ne=aa(),h=c(null),H=c(!1),ie=c([]),L=c(!1),D=c(!1),q=c(null),G=c(!1),A=c(null),J=c(!1),E=c([]),K=c(!1),V=c(null),R=c(null),_=c({current_page:1,per_page:15,total:0,last_page:1}),F=c(!1),I=c(null),Q=c(!1),$=c(!1),O=c(null),W=c(!1),U=c(null),X=c({}),de=j(()=>A.value!==null),ke=j(()=>de.value?"编辑房型":"添加房型"),P=j(()=>U.value!==null),be=j(()=>P.value?"编辑价库":"添加价库"),g=c({name:"",code:"",external_room_id:"",max_occupancy:2,bed_type:"",room_area:null,description:"",is_active:!0}),n=c({dateRange:null,cost_price:0,sale_price:0,stock_total:0,stock_sold:0,stock_available:0}),r=c({biz_date:null,cost_price:0,sale_price:0,stock_total:0,stock_sold:0,stock_available:0,source:"manual"}),M=c(!1),ye={name:[{required:!0,message:"请输入房型名称",trigger:"blur"}],max_occupancy:[{required:!0,message:"请输入最大入住人数",trigger:"blur"},{type:"number",min:1,message:"最大入住人数至少为1",trigger:"blur"}]},Ve={dateRange:[{required:!0,message:"请选择日期范围",trigger:"change"}],cost_price:[{required:!0,message:"请输入成本价",trigger:"blur"},{type:"number",min:0,message:"成本价不能小于0",trigger:"blur"}],sale_price:[{required:!0,message:"请输入售价",trigger:"blur"},{type:"number",min:0,message:"售价不能小于0",trigger:"blur"}],stock_total:[{required:!0,message:"请输入总库存",trigger:"blur"},{type:"number",min:0,message:"总库存不能小于0",trigger:"blur"}]},he={biz_date:[{required:!0,message:"请选择日期",trigger:"change"}],cost_price:[{required:!0,message:"请输入成本价",trigger:"blur"},{type:"number",min:0,message:"成本价不能小于0",trigger:"blur"}],sale_price:[{required:!0,message:"请输入售价",trigger:"blur"},{type:"number",min:0,message:"售价不能小于0",trigger:"blur"}],stock_total:[{required:!0,message:"请输入总库存",trigger:"blur"},{type:"number",min:0,message:"总库存不能小于0",trigger:"blur"}]},xe=()=>{ne.push("/res-hotels")},Se=async()=>{H.value=!0;try{const l=await S.get(`/res-hotels/${z.params.id}`);h.value=l.data.data,await Z()}catch(l){d.error("获取酒店详情失败"),console.error(l),ne.push("/res-hotels")}finally{H.value=!1}},Z=async()=>{L.value=!0;try{const l=await S.get("/res-room-types",{params:{hotel_id:z.params.id}});ie.value=l.data.data||[]}catch(l){d.error("获取房型列表失败"),console.error(l)}finally{L.value=!1}},Ce=()=>{A.value=null,pe(),D.value=!0},we=l=>{A.value=l.id,g.value={name:l.name,code:l.code,external_room_id:l.external_room_id||"",max_occupancy:l.max_occupancy||2,bed_type:l.bed_type||"",room_area:l.room_area||null,description:l.description||"",is_active:l.is_active},D.value=!0},Re=async()=>{q.value&&await q.value.validate(async l=>{var e,p;if(l){G.value=!0;try{const u={...g.value,hotel_id:z.params.id};de.value?(await S.put(`/res-room-types/${A.value}`,u),d.success("房型更新成功")):(await S.post("/res-room-types",u),d.success("房型创建成功")),D.value=!1,await Z()}catch(u){const f=((p=(e=u.response)==null?void 0:e.data)==null?void 0:p.message)||"操作失败";d.error(f)}finally{G.value=!1}}})},Te=async l=>{try{await fe.confirm(`确定要删除房型"${l.name}"吗？删除后无法恢复！`,"提示",{type:"warning",confirmButtonText:"确定删除",cancelButtonText:"取消"}),await S.delete(`/res-room-types/${l.id}`),d.success("删除成功"),await Z()}catch(e){e!=="cancel"&&(d.error("删除失败"),console.error(e))}},pe=()=>{var l;g.value={name:"",code:"",external_room_id:"",max_occupancy:2,bed_type:"",room_area:null,description:"",is_active:!0},(l=q.value)==null||l.clearValidate()},ze=async l=>{V.value=l,J.value=!0,await C(l.id)},C=async l=>{K.value=!0;try{const e={hotel_id:z.params.id,room_type_id:l,page:_.value.current_page,per_page:_.value.per_page};R.value&&R.value.length===2&&(e.start_date=R.value[0],e.end_date=R.value[1]);const p=await S.get("/res-hotel-daily-stocks",{params:e});E.value=p.data.data||[],p.data.current_page!==void 0&&(_.value={current_page:p.data.current_page,per_page:p.data.per_page,total:p.data.total,last_page:p.data.last_page})}catch(e){d.error("获取价库列表失败"),console.error(e)}finally{K.value=!1}},De=()=>{V.value&&(_.value.current_page=1,C(V.value.id))},$e=l=>{_.value.current_page=l,V.value&&C(V.value.id)},Ue=l=>{_.value.per_page=l,_.value.current_page=1,V.value&&C(V.value.id)},Me=()=>{ce(),F.value=!0},Fe=async()=>{I.value&&await I.value.validate(async l=>{var e,p;if(l){if(n.value.sale_price<n.value.cost_price){d.error("售价不能低于成本价");return}if(n.value.stock_sold>n.value.stock_total){d.error("已售库存不能超过总库存");return}if(n.value.stock_available>n.value.stock_total){d.error("可用库存不能超过总库存");return}Q.value=!0;try{await S.post("/res-hotel-daily-stocks/batch",{hotel_id:z.params.id,room_type_id:V.value.id,start_date:n.value.dateRange[0],end_date:n.value.dateRange[1],cost_price:n.value.cost_price,sale_price:n.value.sale_price,stock_total:n.value.stock_total,stock_sold:n.value.stock_sold||0,stock_available:n.value.stock_available}),d.success("批量设置成功"),F.value=!1,_.value.current_page=1,await C(V.value.id)}catch(u){const f=((p=(e=u.response)==null?void 0:e.data)==null?void 0:p.message)||"操作失败";d.error(f)}finally{Q.value=!1}}})},Be=()=>{U.value=null,M.value=!1,me(),$.value=!0},Ye=l=>{if(l.source==="api"){d.warning("接口推送的价库数据不可编辑");return}U.value=l.id,M.value=l.stock_available!==null&&l.stock_available!==void 0,r.value={biz_date:l.biz_date,cost_price:l.cost_price,sale_price:l.sale_price,stock_total:l.stock_total,stock_sold:l.stock_sold,stock_available:l.stock_available??l.stock_total-l.stock_sold,source:l.source},$.value=!0},qe=async()=>{O.value&&await O.value.validate(async l=>{var e,p;if(l){if(r.value.sale_price<r.value.cost_price){d.error("售价不能低于成本价");return}if(r.value.stock_sold>r.value.stock_total){d.error("已售库存不能超过总库存");return}if(r.value.stock_available>r.value.stock_total){d.error("可用库存不能超过总库存");return}W.value=!0;try{const u={hotel_id:z.params.id,room_type_id:V.value.id,...r.value};P.value?(await S.put(`/res-hotel-daily-stocks/${U.value}`,u),d.success("价库更新成功")):(await S.post("/res-hotel-daily-stocks",u),d.success("价库创建成功"),_.value.last_page>0&&(_.value.current_page=_.value.last_page)),$.value=!1,await C(V.value.id)}catch(u){const f=((p=(e=u.response)==null?void 0:e.data)==null?void 0:p.message)||"操作失败";d.error(f)}finally{W.value=!1}}})},Ae=async l=>{var e,p;if(l.source==="api"){d.warning("接口推送的价库数据不可关闭/开启");return}try{const u=l.is_closed?"open":"close";await S.post(`/res-hotel-daily-stocks/${l.id}/${u}`),d.success(l.is_closed?"价库已开启":"价库已关闭"),await C(V.value.id)}catch(u){const f=((p=(e=u.response)==null?void 0:e.data)==null?void 0:p.message)||"操作失败";d.error(f),console.error(u)}},Ee=async l=>{var e,p;try{X.value[l.id]=!0;const u=await S.post(`/res-hotel-daily-stocks/${l.id}/push-to-ota`);u.data.success?d.success(u.data.message||"推送任务已提交，正在后台处理中"):d.error(u.data.message||"推送失败")}catch(u){const f=((p=(e=u.response)==null?void 0:e.data)==null?void 0:p.message)||"推送失败";d.error(f),console.error(u)}finally{X.value[l.id]=!1}},Ie=async l=>{if(l.source==="api"){d.warning("接口推送的价库数据不可删除");return}try{await fe.confirm(`确定要删除日期 ${ve(l.biz_date)} 的价库记录吗？`,"提示",{type:"warning",confirmButtonText:"确定删除",cancelButtonText:"取消"}),await S.delete(`/res-hotel-daily-stocks/${l.id}`),d.success("删除成功"),E.value.length===1&&_.value.current_page>1&&_.value.current_page--,await C(V.value.id)}catch(e){e!=="cancel"&&(d.error("删除失败"),console.error(e))}},Oe=()=>{n.value.stock_available=Math.max(0,n.value.stock_total-n.value.stock_sold)},Pe=()=>{n.value.stock_available=Math.max(0,n.value.stock_total-n.value.stock_sold)},Ne=()=>{n.value.stock_sold=Math.max(0,n.value.stock_total-n.value.stock_available)},je=()=>{M.value?r.value.stock_sold=Math.max(0,r.value.stock_total-r.value.stock_available):r.value.stock_available=Math.max(0,r.value.stock_total-r.value.stock_sold)},He=()=>{M.value||(r.value.stock_available=Math.max(0,r.value.stock_total-r.value.stock_sold))},Le=()=>{M.value=!0,r.value.stock_sold=Math.max(0,r.value.stock_total-r.value.stock_available)},ce=()=>{var l;n.value={dateRange:null,cost_price:0,sale_price:0,stock_total:0,stock_sold:0,stock_available:0},(l=I.value)==null||l.clearValidate()},me=()=>{var l;r.value={biz_date:null,cost_price:0,sale_price:0,stock_total:0,stock_sold:0,stock_available:0,source:"manual"},M.value=!1,(l=O.value)==null||l.clearValidate(),U.value=null},Ge=()=>{V.value=null,E.value=[],R.value=null,U.value=null,_.value={current_page:1,per_page:15,total:0,last_page:1}},Je=l=>{if(!l)return"";const e=new Date(l),p=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),f=String(e.getDate()).padStart(2,"0"),ee=String(e.getHours()).padStart(2,"0"),ae=String(e.getMinutes()).padStart(2,"0");return`${p}-${u}-${f} ${ee}:${ae}`},ve=l=>{if(!l)return"";const e=new Date(l),p=e.getFullYear(),u=String(e.getMonth()+1).padStart(2,"0"),f=String(e.getDate()).padStart(2,"0");return`${p}-${u}-${f}`};return Xe(()=>{Se()}),(l,e)=>{const p=b("el-page-header"),u=b("el-descriptions-item"),f=b("el-tag"),ee=b("el-descriptions"),ae=b("el-divider"),y=b("el-button"),k=b("el-table-column"),_e=b("el-table"),Ke=b("el-card"),B=b("el-input"),v=b("el-form-item"),x=b("el-input-number"),Qe=b("el-switch"),le=b("el-form"),N=b("el-dialog"),te=b("el-date-picker"),We=b("el-pagination"),oe=Ze("loading");return T(),ge("div",null,[a(p,{onBack:xe,title:"返回打包酒店列表"},{content:t(()=>[...e[30]||(e[30]=[w("span",null,"打包酒店详情",-1)])]),_:1}),re((T(),Y(Ke,{style:{"margin-top":"20px"}},{default:t(()=>[h.value?(T(),ge("div",la,[a(ee,{title:"酒店基本信息",column:2,border:""},{default:t(()=>[a(u,{label:"酒店名称"},{default:t(()=>[i(m(h.value.name),1)]),_:1}),a(u,{label:"酒店编码"},{default:t(()=>[i(m(h.value.code),1)]),_:1}),a(u,{label:"所属景区"},{default:t(()=>{var s;return[i(m(((s=h.value.scenic_spot)==null?void 0:s.name)||"-"),1)]}),_:1}),a(u,{label:"软件服务商"},{default:t(()=>{var s;return[i(m(((s=h.value.software_provider)==null?void 0:s.name)||"-"),1)]}),_:1}),a(u,{label:"外部酒店编号"},{default:t(()=>[i(m(h.value.external_hotel_id||"-"),1)]),_:1}),a(u,{label:"状态"},{default:t(()=>[a(f,{type:h.value.is_active?"success":"danger"},{default:t(()=>[i(m(h.value.is_active?"启用":"禁用"),1)]),_:1},8,["type"])]),_:1}),a(u,{label:"地址"},{default:t(()=>[i(m(h.value.address||"-"),1)]),_:1}),a(u,{label:"联系电话"},{default:t(()=>[i(m(h.value.contact_phone||"-"),1)]),_:1}),a(u,{label:"创建时间"},{default:t(()=>[i(m(Je(h.value.created_at)),1)]),_:1}),a(u,{label:"酒店描述",span:2},{default:t(()=>[i(m(h.value.description||"-"),1)]),_:1})]),_:1}),a(ae,{"content-position":"left"},{default:t(()=>[...e[31]||(e[31]=[i("房型管理",-1)])]),_:1}),w("div",ta,[a(y,{type:"primary",onClick:Ce},{default:t(()=>[...e[32]||(e[32]=[i("添加房型",-1)])]),_:1})]),re((T(),Y(_e,{data:ie.value,border:""},{default:t(()=>[a(k,{prop:"name",label:"房型名称",width:"150"}),a(k,{prop:"code",label:"房型编码",width:"150"}),a(k,{prop:"external_room_id",label:"外部房型ID",width:"150"},{default:t(({row:s})=>[i(m(s.external_room_id||"-"),1)]),_:1}),a(k,{prop:"max_occupancy",label:"最大入住人数",width:"120"}),a(k,{prop:"bed_type",label:"床型",width:"100"}),a(k,{prop:"room_area",label:"房间面积（㎡）",width:"120"},{default:t(({row:s})=>[i(m(s.room_area||"-"),1)]),_:1}),a(k,{prop:"description",label:"描述","show-overflow-tooltip":""}),a(k,{prop:"is_active",label:"状态",width:"100"},{default:t(({row:s})=>[a(f,{type:s.is_active?"success":"danger"},{default:t(()=>[i(m(s.is_active?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),a(k,{label:"操作",width:"200",fixed:"right"},{default:t(({row:s})=>[a(y,{size:"small",type:"primary",onClick:o=>ze(s)},{default:t(()=>[...e[33]||(e[33]=[i("管理价库",-1)])]),_:1},8,["onClick"]),a(y,{size:"small",onClick:o=>we(s)},{default:t(()=>[...e[34]||(e[34]=[i("编辑",-1)])]),_:1},8,["onClick"]),a(y,{size:"small",type:"danger",onClick:o=>Te(s)},{default:t(()=>[...e[35]||(e[35]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[oe,L.value]])])):ue("",!0)]),_:1})),[[oe,H.value]]),a(N,{modelValue:D.value,"onUpdate:modelValue":e[9]||(e[9]=s=>D.value=s),title:ke.value,width:"600px",onClose:pe},{footer:t(()=>[a(y,{onClick:e[8]||(e[8]=s=>D.value=!1)},{default:t(()=>[...e[37]||(e[37]=[i("取消",-1)])]),_:1}),a(y,{type:"primary",onClick:Re,loading:G.value},{default:t(()=>[...e[38]||(e[38]=[i("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[a(le,{ref_key:"roomTypeFormRef",ref:q,model:g.value,rules:ye,"label-width":"120px"},{default:t(()=>[a(v,{label:"房型名称",prop:"name"},{default:t(()=>[a(B,{modelValue:g.value.name,"onUpdate:modelValue":e[0]||(e[0]=s=>g.value.name=s),placeholder:"请输入房型名称"},null,8,["modelValue"])]),_:1}),a(v,{label:"房型编码",prop:"code"},{default:t(()=>[a(B,{modelValue:g.value.code,"onUpdate:modelValue":e[1]||(e[1]=s=>g.value.code=s),placeholder:"系统自动生成",disabled:!0},null,8,["modelValue"]),e[36]||(e[36]=w("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 房型编码由系统自动生成，格式：R + 5位数字（如 R00001） ",-1))]),_:1}),a(v,{label:"外部房型ID",prop:"external_room_id"},{default:t(()=>[a(B,{modelValue:g.value.external_room_id,"onUpdate:modelValue":e[2]||(e[2]=s=>g.value.external_room_id=s),placeholder:"用于API对接的第三方房型ID（可选）"},null,8,["modelValue"])]),_:1}),a(v,{label:"最大入住人数",prop:"max_occupancy"},{default:t(()=>[a(x,{modelValue:g.value.max_occupancy,"onUpdate:modelValue":e[3]||(e[3]=s=>g.value.max_occupancy=s),min:1,max:10},null,8,["modelValue"])]),_:1}),a(v,{label:"床型",prop:"bed_type"},{default:t(()=>[a(B,{modelValue:g.value.bed_type,"onUpdate:modelValue":e[4]||(e[4]=s=>g.value.bed_type=s),placeholder:"如：双床、大床等"},null,8,["modelValue"])]),_:1}),a(v,{label:"房间面积（㎡）",prop:"room_area"},{default:t(()=>[a(x,{modelValue:g.value.room_area,"onUpdate:modelValue":e[5]||(e[5]=s=>g.value.room_area=s),min:0,precision:2},null,8,["modelValue"])]),_:1}),a(v,{label:"描述",prop:"description"},{default:t(()=>[a(B,{modelValue:g.value.description,"onUpdate:modelValue":e[6]||(e[6]=s=>g.value.description=s),type:"textarea",rows:3,placeholder:"请输入房型描述"},null,8,["modelValue"])]),_:1}),a(v,{label:"状态",prop:"is_active"},{default:t(()=>[a(Qe,{modelValue:g.value.is_active,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value.is_active=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),a(N,{modelValue:J.value,"onUpdate:modelValue":e[29]||(e[29]=s=>J.value=s),title:"价库管理",width:"1200px",onClose:Ge},{default:t(()=>{var s;return[w("div",oa,[w("span",sa,"房型："+m((s=V.value)==null?void 0:s.name),1),a(y,{type:"primary",onClick:Me},{default:t(()=>[...e[39]||(e[39]=[i("批量设置",-1)])]),_:1}),a(y,{type:"primary",onClick:Be},{default:t(()=>[...e[40]||(e[40]=[i("添加价库",-1)])]),_:1}),a(te,{modelValue:R.value,"onUpdate:modelValue":e[10]||(e[10]=o=>R.value=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{"margin-left":"20px"},"value-format":"YYYY-MM-DD",onChange:De},null,8,["modelValue"])]),re((T(),Y(_e,{data:E.value,border:""},{default:t(()=>[a(k,{prop:"biz_date",label:"日期",width:"120"},{default:t(({row:o})=>[i(m(ve(o.biz_date)),1)]),_:1}),a(k,{prop:"cost_price",label:"成本价",width:"100"},{default:t(({row:o})=>[i(" ¥"+m(o.cost_price),1)]),_:1}),a(k,{prop:"sale_price",label:"售价",width:"100"},{default:t(({row:o})=>[i(" ¥"+m(o.sale_price),1)]),_:1}),a(k,{prop:"stock_total",label:"总库存",width:"100"}),a(k,{prop:"stock_sold",label:"已售",width:"100"}),a(k,{prop:"stock_available",label:"可用库存",width:"100"}),a(k,{prop:"source",label:"来源",width:"100"},{default:t(({row:o})=>[a(f,{type:o.source==="manual"?"primary":"success"},{default:t(()=>[i(m(o.source==="manual"?"人工维护":"接口推送"),1)]),_:2},1032,["type"])]),_:1}),a(k,{prop:"is_closed",label:"状态",width:"100"},{default:t(({row:o})=>[a(f,{type:o.is_closed?"danger":"success"},{default:t(()=>[i(m(o.is_closed?"已关闭":"正常"),1)]),_:2},1032,["type"])]),_:1}),a(k,{label:"操作",width:"350",fixed:"right"},{default:t(({row:o})=>[a(y,{size:"small",onClick:se=>Ye(o),disabled:o.source==="api"},{default:t(()=>[...e[41]||(e[41]=[i(" 编辑 ",-1)])]),_:1},8,["onClick","disabled"]),a(y,{size:"small",type:o.is_closed?"success":"warning",onClick:se=>Ae(o),disabled:o.source==="api"},{default:t(()=>[i(m(o.is_closed?"开启":"关房"),1)]),_:2},1032,["type","onClick","disabled"]),a(y,{size:"small",type:"primary",onClick:se=>Ee(o),loading:X.value[o.id]},{default:t(()=>[...e[42]||(e[42]=[i(" 推送到OTA ",-1)])]),_:1},8,["onClick","loading"]),a(y,{size:"small",type:"danger",onClick:se=>Ie(o),disabled:o.source==="api"},{default:t(()=>[...e[43]||(e[43]=[i(" 删除 ",-1)])]),_:1},8,["onClick","disabled"])]),_:1})]),_:1},8,["data"])),[[oe,K.value]]),_.value.total>0?(T(),Y(We,{key:0,"current-page":_.value.current_page,"onUpdate:currentPage":e[11]||(e[11]=o=>_.value.current_page=o),"page-size":_.value.per_page,"onUpdate:pageSize":e[12]||(e[12]=o=>_.value.per_page=o),"page-sizes":[10,20,50,100],total:_.value.total,layout:"total, sizes, prev, pager, next, jumper",style:{"margin-top":"20px","justify-content":"flex-end"},onSizeChange:Ue,onCurrentChange:$e},null,8,["current-page","page-size","total"])):ue("",!0),a(N,{modelValue:F.value,"onUpdate:modelValue":e[20]||(e[20]=o=>F.value=o),title:"批量设置价库",width:"600px","append-to-body":"",onClose:ce},{footer:t(()=>[a(y,{onClick:e[19]||(e[19]=o=>F.value=!1)},{default:t(()=>[...e[45]||(e[45]=[i("取消",-1)])]),_:1}),a(y,{type:"primary",onClick:Fe,loading:Q.value},{default:t(()=>[...e[46]||(e[46]=[i("确定",-1)])]),_:1},8,["loading"])]),default:t(()=>[a(le,{ref_key:"batchStockFormRef",ref:I,model:n.value,rules:Ve,"label-width":"120px"},{default:t(()=>[a(v,{label:"日期范围",prop:"dateRange"},{default:t(()=>[a(te,{modelValue:n.value.dateRange,"onUpdate:modelValue":e[13]||(e[13]=o=>n.value.dateRange=o),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),a(v,{label:"成本价",prop:"cost_price"},{default:t(()=>[a(x,{modelValue:n.value.cost_price,"onUpdate:modelValue":e[14]||(e[14]=o=>n.value.cost_price=o),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(v,{label:"售价",prop:"sale_price"},{default:t(()=>[a(x,{modelValue:n.value.sale_price,"onUpdate:modelValue":e[15]||(e[15]=o=>n.value.sale_price=o),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(v,{label:"总库存",prop:"stock_total"},{default:t(()=>[a(x,{modelValue:n.value.stock_total,"onUpdate:modelValue":e[16]||(e[16]=o=>n.value.stock_total=o),min:0,style:{width:"100%"},onChange:Oe},null,8,["modelValue"])]),_:1}),a(v,{label:"已售库存",prop:"stock_sold"},{default:t(()=>[a(x,{modelValue:n.value.stock_sold,"onUpdate:modelValue":e[17]||(e[17]=o=>n.value.stock_sold=o),min:0,style:{width:"100%"},onChange:Pe},null,8,["modelValue"])]),_:1}),a(v,{label:"可用库存",prop:"stock_available"},{default:t(()=>[a(x,{modelValue:n.value.stock_available,"onUpdate:modelValue":e[18]||(e[18]=o=>n.value.stock_available=o),min:0,style:{width:"100%"},onChange:Ne},null,8,["modelValue"]),e[44]||(e[44]=w("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 可用库存可人工编辑，推送到OTA时使用此字段。如果未设置，系统将自动计算（总库存 - 已售库存） ",-1))]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),a(N,{modelValue:$.value,"onUpdate:modelValue":e[28]||(e[28]=o=>$.value=o),title:be.value,width:"600px","append-to-body":"",onClose:me},{footer:t(()=>[a(y,{onClick:e[27]||(e[27]=o=>$.value=!1)},{default:t(()=>[...e[48]||(e[48]=[i("取消",-1)])]),_:1}),a(y,{type:"primary",onClick:qe,loading:W.value,disabled:r.value.source==="api"},{default:t(()=>[...e[49]||(e[49]=[i(" 确定 ",-1)])]),_:1},8,["loading","disabled"])]),default:t(()=>[a(le,{ref_key:"stockFormRef",ref:O,model:r.value,rules:he,"label-width":"120px"},{default:t(()=>[a(v,{label:"日期",prop:"biz_date"},{default:t(()=>[a(te,{modelValue:r.value.biz_date,"onUpdate:modelValue":e[21]||(e[21]=o=>r.value.biz_date=o),type:"date",placeholder:"选择日期",style:{width:"100%"},"value-format":"YYYY-MM-DD",disabled:P.value},null,8,["modelValue","disabled"])]),_:1}),a(v,{label:"成本价",prop:"cost_price"},{default:t(()=>[a(x,{modelValue:r.value.cost_price,"onUpdate:modelValue":e[22]||(e[22]=o=>r.value.cost_price=o),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(v,{label:"售价",prop:"sale_price"},{default:t(()=>[a(x,{modelValue:r.value.sale_price,"onUpdate:modelValue":e[23]||(e[23]=o=>r.value.sale_price=o),min:0,precision:2,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),a(v,{label:"总库存",prop:"stock_total"},{default:t(()=>[a(x,{modelValue:r.value.stock_total,"onUpdate:modelValue":e[24]||(e[24]=o=>r.value.stock_total=o),min:0,style:{width:"100%"},onChange:je},null,8,["modelValue"])]),_:1}),a(v,{label:"已售库存",prop:"stock_sold"},{default:t(()=>[a(x,{modelValue:r.value.stock_sold,"onUpdate:modelValue":e[25]||(e[25]=o=>r.value.stock_sold=o),min:0,style:{width:"100%"},onChange:He},null,8,["modelValue"])]),_:1}),a(v,{label:"可用库存",prop:"stock_available"},{default:t(()=>[a(x,{modelValue:r.value.stock_available,"onUpdate:modelValue":e[26]||(e[26]=o=>r.value.stock_available=o),min:0,style:{width:"100%"},onChange:Le,disabled:!1},null,8,["modelValue"]),e[47]||(e[47]=w("div",{style:{"font-size":"12px",color:"#909399","margin-top":"5px"}}," 可用库存可人工编辑，推送到OTA时使用此字段。如果未设置，系统将自动计算（总库存 - 已售库存） ",-1))]),_:1}),P.value?(T(),Y(v,{key:0,label:"来源"},{default:t(()=>[a(f,{type:r.value.source==="manual"?"primary":"success"},{default:t(()=>[i(m(r.value.source==="manual"?"人工维护":"接口推送"),1)]),_:1},8,["type"]),w("span",ra,m(r.value.source==="manual"?"（可编辑）":"（接口推送，不可编辑）"),1)]),_:1})):ue("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue","title"])]}),_:1},8,["modelValue"])])}}};export{ia as default};
